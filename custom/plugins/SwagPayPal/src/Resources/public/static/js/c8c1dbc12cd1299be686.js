"use strict";(window["webpackJsonpPluginswag-pay-pal"]=window["webpackJsonpPluginswag-pay-pal"]||[]).push([[113],{2113:function(e,a,t){t.r(a);let{debug:n}=Shopware.Utils;a.default=Shopware.Mixin.register("swag-paypal-credentials-loader",Shopware.Component.wrapComponentConfig({inject:["SwagPayPalApiCredentialsService"],data(){return{isLoading:!1,isGetCredentialsSuccessful:!1,lastOnboardingSandbox:!1,nonceLive:`${Shopware.Utils.createId()}${Shopware.Utils.createId()}`,nonceSandbox:`${Shopware.Utils.createId()}${Shopware.Utils.createId()}`,payPalPartnerIdLive:"DYKPBPEAW5JNA",payPalPartnerClientIdLive:"AR1aQ13lHxH1c6b3CDd8wSY6SWad2Lt5fv5WkNIZg-qChBoGNfHr2kT180otUmvE_xXtwkgahXUBBurW",payPalPartnerIdSandbox:"45KXQA7PULGAG",payPalPartnerClientIdSandbox:"AQ9g8qMYHpE8s028VCq_GO3Roy9pjeqGDjKTkR_sxzX0FtncBb3QUWbFtoQMtdpe2lG9NpnDT419dK8s",requestParams:{channelId:"partner",product:"ppcp",secondaryProducts:"advanced_vaulting,PAYMENT_METHODS",capabilities:"APPLE_PAY,GOOGLE_PAY,PAY_UPON_INVOICE,PAYPAL_WALLET_VAULTING_ADVANCED",integrationType:"FO",features:["PAYMENT","REFUND","READ_SELLER_DISPUTE","UPDATE_SELLER_DISPUTE","ADVANCED_TRANSACTIONS_SEARCH","ACCESS_MERCHANT_INFORMATION","TRACKING_SHIPMENT_READWRITE","VAULT","BILLING_AGREEMENT"],displayMode:"minibrowser",partnerLogoUrl:"https://assets.shopware.com/media/logos/shopware_logo_blue.svg"}}},computed:{returnUrl(){return`${window.location.origin}${window.location.pathname}#${this.$route.path}`},onboardingUrlLive(){let e=this.createRequestParameter({partnerId:this.payPalPartnerIdLive,partnerClientId:this.payPalPartnerClientIdLive,returnToPartnerUrl:this.returnUrl,sellerNonce:this.nonceLive});return`https://www.paypal.com/bizsignup/partner/entry?${e.toString()}`},onboardingUrlSandbox(){let e=this.createRequestParameter({partnerId:this.payPalPartnerIdSandbox,partnerClientId:this.payPalPartnerClientIdSandbox,returnToPartnerUrl:this.returnUrl,sellerNonce:this.nonceSandbox});return`https://www.sandbox.paypal.com/bizsignup/partner/entry?${e.toString()}`}},created(){this.$on("paypal-onboarding-finish",this.getPayPalCredentials.bind(this)),window.onboardingCallbackLive=(e,a)=>{this.$emit("paypal-onboarding-finish",{authCode:e,sharedId:a,sandbox:!1})},window.onboardingCallbackSandbox=(e,a)=>{this.$emit("paypal-onboarding-finish",{authCode:e,sharedId:a,sandbox:!0})}},mounted(){this.createScript()},destroyed(){this.$off("paypal-onboarding-finish")},methods:{createRequestParameter(e={}){let a={...this.requestParams,...e};return Object.keys(a).reduce((e,t)=>{let n=a[t];return Array.isArray(n)&&(n=n.join(",")),e.append(t,n),e},new URLSearchParams)},createScript(){let e="paypal-js";if(document.getElementById(e))window.PAYPAL&&this.renderPayPalButton();else{let a=document.createElement("script");a.id=e,a.type="text/javascript",a.src="https://www.paypal.com/webapps/merchantboarding/js/lib/lightbox/partner.js",a.async=!0,a.addEventListener("load",this.renderPayPalButton.bind(this),!1),document.head.appendChild(a)}},renderPayPalButton(){window.PAYPAL.apps.Signup.render=function(){window.PAYPAL.apps.Signup.timeout&&clearTimeout(window.PAYPAL.apps.Signup.timeout),window.PAYPAL.apps.Signup.timeout=setTimeout(window.PAYPAL.apps.Signup.render,300)},window.PAYPAL.apps.Signup.render()},getPayPalCredentials({authCode:e,sharedId:a,sandbox:t}){return this.isLoading?Promise.resolve(!1):(this.isGetCredentialsSuccessful=null,this.lastOnboardingSandbox=t,this.$emit("on-change-loading",!0),this.SwagPayPalApiCredentialsService.getApiCredentials(e,a,t?this.nonceSandbox:this.nonceLive,t).then(e=>{this.isGetCredentialsSuccessful=!0,this.onPayPalCredentialsLoadSuccess(e.client_id,e.client_secret,e.payer_id,t)}).catch(()=>{this.isGetCredentialsSuccessful=!1,this.onPayPalCredentialsLoadFailed(t)}).finally(()=>{this.$emit("on-change-loading",!1)}))},onPayPalCredentialsLoadSuccess(e,a,t,i){n.warn("swag-paypal-credentials-loader Mixin",'When using the paypal-credentials-loader mixin you have to implement your custom "onPayPalCredentialsLoadSuccess()" method.')},onPayPalCredentialsLoadFailed(e){n.warn("swag-paypal-credentials-loader Mixin",'When using the paypal-credentials-loader mixin you have to implement your custom "onPayPalCredentialsLoadFailed()" method.')}}}))}}]);